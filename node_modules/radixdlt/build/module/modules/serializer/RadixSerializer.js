import { TSMap } from 'typescript-map';
import { RadixApplicationPayloadAtom, RadixBasicPayloadAtom, RadixConsumable, RadixConsumer, RadixECKeyPair, RadixEmission, RadixNullAtom, RadixNullJunk, RadixSignature, RadixTransactionAtom, RadixBase64, RadixEUID, RadixHash, RadixEncryptor, RadixAtomFeeConsumable, RadixFeeConsumable, RadixTokenClass } from '../RadixAtomModel';
import Long from 'long';
export var DataTypes;
(function (DataTypes) {
    DataTypes[DataTypes["BOOLEAN"] = 1] = "BOOLEAN";
    DataTypes[DataTypes["NUMBER"] = 2] = "NUMBER";
    DataTypes[DataTypes["STRING"] = 3] = "STRING";
    DataTypes[DataTypes["BYTES"] = 4] = "BYTES";
    DataTypes[DataTypes["OBJECT"] = 5] = "OBJECT";
    DataTypes[DataTypes["ARRAY"] = 6] = "ARRAY";
    DataTypes[DataTypes["EUID"] = 7] = "EUID";
    DataTypes[DataTypes["HASH"] = 8] = "HASH";
})(DataTypes || (DataTypes = {}));
export default class RadixSerializer {
    static fromJson(json) {
        if (Array.isArray(json)) {
            let output = [];
            for (let item of json) {
                output.push(RadixSerializer.fromJson(item));
            }
            return output;
        }
        else if (typeof json === 'object') {
            return RadixSerializer.fromJsonObject(json);
        }
        else {
            return json;
        }
    }
    static fromJsonObject(jsonObject) {
        let output = {};
        for (let key in jsonObject) {
            output[key] = RadixSerializer.fromJson(jsonObject[key]);
        }
        if ('serializer' in output) {
            let type = output['serializer'];
            switch (type) {
                case RadixEUID.SERIALIZER:
                    return RadixEUID.fromJson(output);
                case RadixHash.SERIALIZER:
                    return RadixHash.fromJson(output);
                case RadixBase64.SERIALIZER:
                    return RadixBase64.fromJson(output);
                case RadixNullAtom.SERIALIZER:
                    return new RadixNullAtom(output);
                case RadixNullJunk.SERIALIZER:
                    return new RadixNullJunk(output);
                case RadixSignature.SERIALIZER:
                    return new RadixSignature(output);
                case RadixBasicPayloadAtom.SERIALIZER:
                    return new RadixBasicPayloadAtom(output);
                case RadixApplicationPayloadAtom.SERIALIZER:
                    return new RadixApplicationPayloadAtom(output);
                case RadixECKeyPair.SERIALIZER:
                    return new RadixECKeyPair(output);
                case RadixEncryptor.SERIALIZER:
                    return new RadixEncryptor(output);
                case RadixTransactionAtom.SERIALIZER:
                    return new RadixTransactionAtom(output);
                case RadixEmission.SERIALIZER:
                    return new RadixEmission(output);
                case RadixConsumable.SERIALIZER:
                    return new RadixConsumable(output);
                case RadixConsumer.SERIALIZER:
                    return new RadixConsumer(output);
                case RadixTokenClass.SERIALIZER:
                    return new RadixTokenClass(output);
                case RadixFeeConsumable.SERIALIZER:
                    return new RadixFeeConsumable(output);
                case RadixAtomFeeConsumable.SERIALIZER:
                    return new RadixAtomFeeConsumable(output);
                default:
                    // console.log(`Serializer "${type}" not implemented`)
                    break;
            }
        }
        return output;
    }
    static toJson(data) {
        if (Array.isArray(data)) {
            let output = [];
            for (let item of data) {
                output.push(RadixSerializer.toJson(item));
            }
            return output;
        }
        else if (typeof data === 'string' ||
            typeof data === 'number' ||
            typeof data === 'boolean' ||
            data instanceof Long) {
            return data;
        }
        else if (data !== null && typeof data === 'object') {
            if (typeof data.toJson === 'function') {
                return data.toJson();
            }
            else {
                let output = {};
                for (let key in data) {
                    let serialized = RadixSerializer.toJson(data[key]);
                    if (serialized) {
                        output[key] = serialized;
                    }
                }
                return output;
            }
        }
    }
    static fromByteArray(bytes) {
        // Read 1 byte for type
        let type = bytes.readUInt8(0);
        // Read 4 bytes for length
        let length = bytes.readUInt32BE(1);
        // Switch on type
        switch (type) {
            case DataTypes.BOOLEAN: {
                return bytes.readUInt8(5) ? true : false;
            }
            case DataTypes.NUMBER: {
                return Long.fromBytesBE([...bytes.slice(5, 13)]).toNumber();
            }
            case DataTypes.STRING: {
                return bytes.slice(5, 5 + length).toString('utf8');
            }
            case DataTypes.BYTES: {
                return new RadixBase64(bytes.slice(5, 5 + length));
            }
            case DataTypes.OBJECT: {
                return this.fromObjectByteArray(bytes);
            }
            case DataTypes.ARRAY: {
                let output = [];
                let offset = 5;
                while (offset < length) {
                    // Read 2nd to 5th bytes to find out the length of the value
                    let valueLength = bytes.readUInt32BE(offset + 1);
                    output.push(this.fromByteArray(bytes.slice(offset, offset + 5 + valueLength)));
                    offset += 5 + valueLength;
                }
                return output;
            }
            case DataTypes.EUID: {
                return new RadixEUID(bytes.slice(5, 5 + length));
            }
            case DataTypes.HASH: {
                return new RadixHash(bytes.slice(5, 5 + length));
            }
        }
    }
    static fromObjectByteArray(bytes) {
        // Read 4 bytes for length
        let length = bytes.readUInt32BE(1);
        let offset = 5;
        let output = {};
        while (offset < length + 5) {
            let keyLength = bytes.readUInt8(offset);
            offset++;
            let key = bytes.slice(offset, offset + keyLength).toString('utf8');
            offset += keyLength;
            // Read 2nd to 5th bytes to find out the length of the value
            let valueLength = bytes.readUInt32BE(offset + 1);
            output[key] = this.fromByteArray(bytes.slice(offset, offset + 5 + valueLength));
            offset += 5 + valueLength;
        }
        // Check if has serializer, cast
        if ('serializer' in output) {
            let type = output['serializer'];
            switch (type) {
                case RadixNullAtom.SERIALIZER:
                    return new RadixNullAtom(output);
                case RadixNullJunk.SERIALIZER:
                    return new RadixNullJunk(output);
                case RadixSignature.SERIALIZER:
                    return new RadixSignature(output);
                case RadixBasicPayloadAtom.SERIALIZER:
                    return new RadixBasicPayloadAtom(output);
                case RadixECKeyPair.SERIALIZER:
                    return new RadixECKeyPair(output);
                case RadixEncryptor.SERIALIZER:
                    return new RadixEncryptor(output);
                default:
                    // console.log(`Serializer "${type}" not implemented`)
                    break;
            }
        }
        return output;
    }
    static toByteArray(data) {
        let output = new Buffer([]);
        if (Array.isArray(data)) {
            let type = DataTypes.ARRAY;
            let length = 0;
            // Serialize all items
            let serialized = [];
            for (let item of data) {
                let serializedItem = this.toByteArray(item);
                length += serializedItem.length;
                serialized.push(serializedItem);
            }
            // Write everything to the buffer
            output = Buffer.alloc(length + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length, 1);
            let position = 5;
            for (let item of serialized) {
                item.copy(output, position);
                position += item.length;
            }
        }
        else if (typeof data === 'number' || data instanceof Long) {
            let type = DataTypes.NUMBER;
            let length = 8;
            let bufferData = (data instanceof Long) ? Buffer.from(data.toBytes()) : Buffer.from(Long.fromNumber(data).toBytes());
            output = Buffer.alloc(length + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length, 1);
            bufferData.copy(output, 5);
        }
        else if (typeof data === 'object') {
            if (typeof data.toByteArray === 'function') {
                // Radix objects
                output = data.toByteArray();
            }
            else {
                // Generic object
                let type = DataTypes.OBJECT;
                let length = 0;
                // Serialize all properties
                // Build a map sorted by property name
                let map = new TSMap();
                for (let key in data) {
                    let serializedValue = this.toByteArray(data[key]);
                    length += key.length + 1 + serializedValue.length;
                    map.sortedSet(key, serializedValue);
                }
                // Write everything to the buffer
                output = Buffer.alloc(length + 5);
                output.writeUInt8(type, 0);
                output.writeUInt32BE(length, 1);
                let position = 5;
                for (let key of map.keys()) {
                    let value = map.get(key);
                    output.writeUInt8(key.length, position);
                    position++;
                    output.write(key, position);
                    position += key.length;
                    value.copy(output, position);
                    position += value.length;
                }
            }
        }
        else if (typeof data === 'boolean') {
            let type = DataTypes.BOOLEAN;
            let length = 1;
            output = Buffer.alloc(length + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length, 1);
            output.writeUInt8(data ? 1 : 0, 5);
        }
        else if (typeof data === 'string') {
            let type = DataTypes.STRING;
            let bufferData = Buffer.from(data, 'utf8');
            let length = bufferData.length;
            output = Buffer.alloc(length + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length, 1);
            bufferData.copy(output, 5);
        }
        else if (typeof data === 'function') {
            // Ignore
        }
        else {
            console.warn('Unknown type', data);
        }
        return output;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaXhTZXJpYWxpemVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL21vZHVsZXMvc2VyaWFsaXplci9SYWRpeFNlcmlhbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFBO0FBRXRDLE9BQU8sRUFDSCwyQkFBMkIsRUFDM0IscUJBQXFCLEVBQ3JCLGVBQWUsRUFDZixhQUFhLEVBQ2IsY0FBYyxFQUNkLGFBQWEsRUFDYixhQUFhLEVBQ2IsYUFBYSxFQUNiLGNBQWMsRUFDZCxvQkFBb0IsRUFDcEIsV0FBVyxFQUNYLFNBQVMsRUFDVCxTQUFTLEVBQ1QsY0FBYyxFQUNkLHNCQUFzQixFQUN0QixrQkFBa0IsRUFDbEIsZUFBZSxFQUNsQixNQUFNLG1CQUFtQixDQUFBO0FBRTFCLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQTtBQUV2QixNQUFNLENBQU4sSUFBWSxTQVNYO0FBVEQsV0FBWSxTQUFTO0lBQ2pCLCtDQUFXLENBQUE7SUFDWCw2Q0FBVSxDQUFBO0lBQ1YsNkNBQVUsQ0FBQTtJQUNWLDJDQUFTLENBQUE7SUFDVCw2Q0FBVSxDQUFBO0lBQ1YsMkNBQVMsQ0FBQTtJQUNULHlDQUFRLENBQUE7SUFDUix5Q0FBUSxDQUFBO0FBQ1osQ0FBQyxFQVRXLFNBQVMsS0FBVCxTQUFTLFFBU3BCO0FBRUQsTUFBTSxDQUFDLE9BQU8sT0FBTyxlQUFlO0lBQ3pCLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBUztRQUM1QixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDckIsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFBO1lBQ2YsS0FBSyxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUU7Z0JBQ25CLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFBO2FBQzlDO1lBQ0QsT0FBTyxNQUFNLENBQUE7U0FDaEI7YUFBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtZQUNqQyxPQUFPLGVBQWUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUE7U0FDOUM7YUFBTTtZQUNILE9BQU8sSUFBSSxDQUFBO1NBQ2Q7SUFDTCxDQUFDO0lBRU0sTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFrQjtRQUMzQyxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUE7UUFFZixLQUFLLElBQUksR0FBRyxJQUFJLFVBQVUsRUFBRTtZQUN4QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsZUFBZSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQTtTQUMxRDtRQUVELElBQUksWUFBWSxJQUFJLE1BQU0sRUFBRTtZQUN4QixJQUFJLElBQUksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUE7WUFFL0IsUUFBUSxJQUFJLEVBQUU7Z0JBQ1YsS0FBSyxTQUFTLENBQUMsVUFBVTtvQkFDckIsT0FBTyxTQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNyQyxLQUFLLFNBQVMsQ0FBQyxVQUFVO29CQUNyQixPQUFPLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLEtBQUssV0FBVyxDQUFDLFVBQVU7b0JBQ3ZCLE9BQU8sV0FBVyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDdkMsS0FBSyxhQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyxhQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyxjQUFjLENBQUMsVUFBVTtvQkFDMUIsT0FBTyxJQUFJLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDckMsS0FBSyxxQkFBcUIsQ0FBQyxVQUFVO29CQUNqQyxPQUFPLElBQUkscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQzVDLEtBQUssMkJBQTJCLENBQUMsVUFBVTtvQkFDdkMsT0FBTyxJQUFJLDJCQUEyQixDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNsRCxLQUFLLGNBQWMsQ0FBQyxVQUFVO29CQUMxQixPQUFPLElBQUksY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNyQyxLQUFLLGNBQWMsQ0FBQyxVQUFVO29CQUMxQixPQUFPLElBQUksY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNyQyxLQUFLLG9CQUFvQixDQUFDLFVBQVU7b0JBQ2hDLE9BQU8sSUFBSSxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDM0MsS0FBSyxhQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyxlQUFlLENBQUMsVUFBVTtvQkFDM0IsT0FBTyxJQUFJLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDdEMsS0FBSyxhQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyxlQUFlLENBQUMsVUFBVTtvQkFDM0IsT0FBTyxJQUFJLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDdEMsS0FBSyxrQkFBa0IsQ0FBQyxVQUFVO29CQUM5QixPQUFPLElBQUksa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3pDLEtBQUssc0JBQXNCLENBQUMsVUFBVTtvQkFDbEMsT0FBTyxJQUFJLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUM3QztvQkFDSSxzREFBc0Q7b0JBQ3RELE1BQUs7YUFDWjtTQUNKO1FBRUQsT0FBTyxNQUFNLENBQUE7SUFDakIsQ0FBQztJQUVNLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBUztRQUMxQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDckIsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFBO1lBQ2YsS0FBSyxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUU7Z0JBQ25CLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFBO2FBQzVDO1lBQ0QsT0FBTyxNQUFNLENBQUE7U0FDaEI7YUFBTSxJQUNILE9BQU8sSUFBSSxLQUFLLFFBQVE7WUFDeEIsT0FBTyxJQUFJLEtBQUssUUFBUTtZQUN4QixPQUFPLElBQUksS0FBSyxTQUFTO1lBQ3pCLElBQUksWUFBWSxJQUFJLEVBQ3RCO1lBQ0UsT0FBTyxJQUFJLENBQUE7U0FDZDthQUFNLElBQUksSUFBSSxLQUFLLElBQUksSUFBSSxPQUFPLElBQUksS0FBSyxRQUFRLEVBQUU7WUFDbEQsSUFBSSxPQUFPLElBQUksQ0FBQyxNQUFNLEtBQUssVUFBVSxFQUFFO2dCQUNuQyxPQUFPLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQTthQUN2QjtpQkFBTTtnQkFDSCxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUE7Z0JBQ2YsS0FBSyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUU7b0JBQ2xCLElBQUksVUFBVSxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7b0JBQ2xELElBQUksVUFBVSxFQUFFO3dCQUNaLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVLENBQUE7cUJBQzNCO2lCQUNKO2dCQUVELE9BQU8sTUFBTSxDQUFBO2FBQ2hCO1NBQ0o7SUFDTCxDQUFDO0lBRU0sTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFhO1FBQ3JDLHVCQUF1QjtRQUN2QixJQUFJLElBQUksR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQzdCLDBCQUEwQjtRQUMxQixJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBRWxDLGlCQUFpQjtRQUNqQixRQUFRLElBQUksRUFBRTtZQUNWLEtBQUssU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUNwQixPQUFPLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFBO2FBQzNDO1lBQ0QsS0FBSyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ25CLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO2FBQzlEO1lBQ0QsS0FBSyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ25CLE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQTthQUNyRDtZQUNELEtBQUssU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUNsQixPQUFPLElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFBO2FBQ3JEO1lBQ0QsS0FBSyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ25CLE9BQU8sSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFBO2FBQ3pDO1lBQ0QsS0FBSyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ2xCLElBQUksTUFBTSxHQUFlLEVBQUUsQ0FBQTtnQkFDM0IsSUFBSSxNQUFNLEdBQUcsQ0FBQyxDQUFBO2dCQUVkLE9BQU8sTUFBTSxHQUFHLE1BQU0sRUFBRTtvQkFDcEIsNERBQTREO29CQUM1RCxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtvQkFFaEQsTUFBTSxDQUFDLElBQUksQ0FDUCxJQUFJLENBQUMsYUFBYSxDQUNkLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLE1BQU0sR0FBRyxDQUFDLEdBQUcsV0FBVyxDQUFDLENBQ2hELENBQ0osQ0FBQTtvQkFFRCxNQUFNLElBQUksQ0FBQyxHQUFHLFdBQVcsQ0FBQTtpQkFDNUI7Z0JBRUQsT0FBTyxNQUFNLENBQUE7YUFDaEI7WUFDRCxLQUFLLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDakIsT0FBTyxJQUFJLFNBQVMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQTthQUNuRDtZQUNELEtBQUssU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNqQixPQUFPLElBQUksU0FBUyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFBO2FBQ25EO1NBQ0o7SUFDTCxDQUFDO0lBRU0sTUFBTSxDQUFDLG1CQUFtQixDQUFDLEtBQWE7UUFDM0MsMEJBQTBCO1FBQzFCLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFFbEMsSUFBSSxNQUFNLEdBQUcsQ0FBQyxDQUFBO1FBQ2QsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFBO1FBQ2YsT0FBTyxNQUFNLEdBQUcsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUN4QixJQUFJLFNBQVMsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBQ3ZDLE1BQU0sRUFBRSxDQUFBO1lBQ1IsSUFBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsTUFBTSxHQUFHLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUNsRSxNQUFNLElBQUksU0FBUyxDQUFBO1lBRW5CLDREQUE0RDtZQUM1RCxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUVoRCxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FDNUIsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsTUFBTSxHQUFHLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FDaEQsQ0FBQTtZQUVELE1BQU0sSUFBSSxDQUFDLEdBQUcsV0FBVyxDQUFBO1NBQzVCO1FBRUQsZ0NBQWdDO1FBQ2hDLElBQUksWUFBWSxJQUFJLE1BQU0sRUFBRTtZQUN4QixJQUFJLElBQUksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUE7WUFFL0IsUUFBUSxJQUFJLEVBQUU7Z0JBQ1YsS0FBSyxhQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyxhQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyxjQUFjLENBQUMsVUFBVTtvQkFDMUIsT0FBTyxJQUFJLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDckMsS0FBSyxxQkFBcUIsQ0FBQyxVQUFVO29CQUNqQyxPQUFPLElBQUkscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQzVDLEtBQUssY0FBYyxDQUFDLFVBQVU7b0JBQzFCLE9BQU8sSUFBSSxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLEtBQUssY0FBYyxDQUFDLFVBQVU7b0JBQzFCLE9BQU8sSUFBSSxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDO29CQUNJLHNEQUFzRDtvQkFDdEQsTUFBSzthQUNaO1NBQ0o7UUFFRCxPQUFPLE1BQU0sQ0FBQTtJQUNqQixDQUFDO0lBRU0sTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFTO1FBQy9CLElBQUksTUFBTSxHQUFXLElBQUksTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBRW5DLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNyQixJQUFJLElBQUksR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFBO1lBQzFCLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQTtZQUVkLHNCQUFzQjtZQUN0QixJQUFJLFVBQVUsR0FBRyxFQUFFLENBQUE7WUFDbkIsS0FBSyxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUU7Z0JBQ25CLElBQUksY0FBYyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUE7Z0JBQzNDLE1BQU0sSUFBSSxjQUFjLENBQUMsTUFBTSxDQUFBO2dCQUMvQixVQUFVLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFBO2FBQ2xDO1lBRUQsaUNBQWlDO1lBQ2pDLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUNqQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUMxQixNQUFNLENBQUMsYUFBYSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUUvQixJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUE7WUFDaEIsS0FBSyxJQUFJLElBQUksSUFBSSxVQUFVLEVBQUU7Z0JBQ3pCLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFBO2dCQUMzQixRQUFRLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQTthQUMxQjtTQUNKO2FBQU0sSUFBSSxPQUFPLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxZQUFZLElBQUksRUFBRTtZQUN6RCxJQUFJLElBQUksR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFBO1lBQzNCLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQTtZQUNkLElBQUksVUFBVSxHQUFHLENBQUMsSUFBSSxZQUFZLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQTtZQUVwSCxNQUFNLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUE7WUFFakMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDMUIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDL0IsVUFBVSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7U0FDN0I7YUFBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtZQUNqQyxJQUFJLE9BQU8sSUFBSSxDQUFDLFdBQVcsS0FBSyxVQUFVLEVBQUU7Z0JBQ3hDLGdCQUFnQjtnQkFDaEIsTUFBTSxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQTthQUM5QjtpQkFBTTtnQkFDSCxpQkFBaUI7Z0JBQ2pCLElBQUksSUFBSSxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUE7Z0JBQzNCLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQTtnQkFFZCwyQkFBMkI7Z0JBQzNCLHNDQUFzQztnQkFDdEMsSUFBSSxHQUFHLEdBQUcsSUFBSSxLQUFLLEVBQWtCLENBQUE7Z0JBQ3JDLEtBQUssSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFO29CQUNsQixJQUFJLGVBQWUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO29CQUNqRCxNQUFNLElBQUksR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQTtvQkFDakQsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsZUFBZSxDQUFDLENBQUE7aUJBQ3RDO2dCQUVELGlDQUFpQztnQkFDakMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFBO2dCQUNqQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtnQkFDMUIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7Z0JBRS9CLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQTtnQkFDaEIsS0FBSyxJQUFJLEdBQUcsSUFBSSxHQUFHLENBQUMsSUFBSSxFQUFFLEVBQUU7b0JBQ3hCLElBQUksS0FBSyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7b0JBRXhCLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQTtvQkFDdkMsUUFBUSxFQUFFLENBQUE7b0JBQ1YsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUE7b0JBQzNCLFFBQVEsSUFBSSxHQUFHLENBQUMsTUFBTSxDQUFBO29CQUN0QixLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQTtvQkFDNUIsUUFBUSxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUE7aUJBQzNCO2FBQ0o7U0FDSjthQUFNLElBQUksT0FBTyxJQUFJLEtBQUssU0FBUyxFQUFFO1lBQ2xDLElBQUksSUFBSSxHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUE7WUFDNUIsSUFBSSxNQUFNLEdBQUcsQ0FBQyxDQUFBO1lBRWQsTUFBTSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFBO1lBRWpDLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFBO1lBQzFCLE1BQU0sQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFBO1lBQy9CLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtTQUNyQzthQUFNLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFO1lBQ2pDLElBQUksSUFBSSxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUE7WUFDM0IsSUFBSSxVQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUE7WUFDMUMsSUFBSSxNQUFNLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQTtZQUU5QixNQUFNLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUE7WUFFakMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDMUIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDL0IsVUFBVSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7U0FDN0I7YUFBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFVBQVUsRUFBRTtZQUNuQyxTQUFTO1NBQ1o7YUFBTTtZQUNILE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFBO1NBQ3JDO1FBRUQsT0FBTyxNQUFNLENBQUE7SUFDakIsQ0FBQztDQUNKIn0=