import RadixECIES from './RadixECIES';
import { RadixBasicContainer } from '../RadixAtomModel';
export default class RadixEncryptor extends RadixBasicContainer {
    constructor(json) {
        super(json);
        this.serializationProperties.push('protectors');
    }
    getKey(accessor) {
        for (let protector of this.protectors) {
            try {
                let decryptedPrivateKey = RadixECIES.decrypt(accessor.keyPair.getPrivate(), protector.data);
                return decryptedPrivateKey;
            }
            catch (e) {
                // console.log('Could not decrypt: ', e)
            }
        }
        throw new Error('Could not decrypt any protectors');
    }
    decrypt(data, accessor) {
        let privateKey = this.getKey(accessor);
        return RadixECIES.decrypt(privateKey, data.data);
    }
}
RadixEncryptor.SERIALIZER = 105401064;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaXhFbmNyeXB0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbW9kdWxlcy9jcnlwdG8vUmFkaXhFbmNyeXB0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxVQUFVLE1BQU0sY0FBYyxDQUFBO0FBRXJDLE9BQU8sRUFBRSxtQkFBbUIsRUFBNkIsTUFBTSxtQkFBbUIsQ0FBQTtBQUVsRixNQUFNLENBQUMsT0FBTyxPQUFPLGNBQWUsU0FBUSxtQkFBbUI7SUFLM0QsWUFBWSxJQUFhO1FBQ3JCLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUVYLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUE7SUFDbkQsQ0FBQztJQUVELE1BQU0sQ0FBQyxRQUFzQjtRQUN6QixLQUFLLElBQUksU0FBUyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDbkMsSUFBSTtnQkFDQSxJQUFJLG1CQUFtQixHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQ3hDLFFBQVEsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLEVBQzdCLFNBQVMsQ0FBQyxJQUFJLENBQ2pCLENBQUE7Z0JBQ0QsT0FBTyxtQkFBbUIsQ0FBQTthQUM3QjtZQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNSLHdDQUF3QzthQUMzQztTQUNKO1FBRUQsTUFBTSxJQUFJLEtBQUssQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFBO0lBQ3ZELENBQUM7SUFFRCxPQUFPLENBQUMsSUFBaUIsRUFBRSxRQUFzQjtRQUM3QyxJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFBO1FBRXRDLE9BQU8sVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ3BELENBQUM7O0FBOUJNLHlCQUFVLEdBQUcsU0FBUyxDQUFBIn0=