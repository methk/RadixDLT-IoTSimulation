"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var typescript_map_1 = require("typescript-map");
var RadixAtomModel_1 = require("../RadixAtomModel");
var long_1 = tslib_1.__importDefault(require("long"));
var DataTypes;
(function (DataTypes) {
    DataTypes[DataTypes["BOOLEAN"] = 1] = "BOOLEAN";
    DataTypes[DataTypes["NUMBER"] = 2] = "NUMBER";
    DataTypes[DataTypes["STRING"] = 3] = "STRING";
    DataTypes[DataTypes["BYTES"] = 4] = "BYTES";
    DataTypes[DataTypes["OBJECT"] = 5] = "OBJECT";
    DataTypes[DataTypes["ARRAY"] = 6] = "ARRAY";
    DataTypes[DataTypes["EUID"] = 7] = "EUID";
    DataTypes[DataTypes["HASH"] = 8] = "HASH";
})(DataTypes = exports.DataTypes || (exports.DataTypes = {}));
var RadixSerializer = /** @class */ (function () {
    function RadixSerializer() {
    }
    RadixSerializer.fromJson = function (json) {
        var e_1, _a;
        if (Array.isArray(json)) {
            var output = [];
            try {
                for (var json_1 = tslib_1.__values(json), json_1_1 = json_1.next(); !json_1_1.done; json_1_1 = json_1.next()) {
                    var item = json_1_1.value;
                    output.push(RadixSerializer.fromJson(item));
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (json_1_1 && !json_1_1.done && (_a = json_1.return)) _a.call(json_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return output;
        }
        else if (typeof json === 'object') {
            return RadixSerializer.fromJsonObject(json);
        }
        else {
            return json;
        }
    };
    RadixSerializer.fromJsonObject = function (jsonObject) {
        var output = {};
        for (var key in jsonObject) {
            output[key] = RadixSerializer.fromJson(jsonObject[key]);
        }
        if ('serializer' in output) {
            var type = output['serializer'];
            switch (type) {
                case RadixAtomModel_1.RadixEUID.SERIALIZER:
                    return RadixAtomModel_1.RadixEUID.fromJson(output);
                case RadixAtomModel_1.RadixHash.SERIALIZER:
                    return RadixAtomModel_1.RadixHash.fromJson(output);
                case RadixAtomModel_1.RadixBase64.SERIALIZER:
                    return RadixAtomModel_1.RadixBase64.fromJson(output);
                case RadixAtomModel_1.RadixNullAtom.SERIALIZER:
                    return new RadixAtomModel_1.RadixNullAtom(output);
                case RadixAtomModel_1.RadixNullJunk.SERIALIZER:
                    return new RadixAtomModel_1.RadixNullJunk(output);
                case RadixAtomModel_1.RadixSignature.SERIALIZER:
                    return new RadixAtomModel_1.RadixSignature(output);
                case RadixAtomModel_1.RadixBasicPayloadAtom.SERIALIZER:
                    return new RadixAtomModel_1.RadixBasicPayloadAtom(output);
                case RadixAtomModel_1.RadixApplicationPayloadAtom.SERIALIZER:
                    return new RadixAtomModel_1.RadixApplicationPayloadAtom(output);
                case RadixAtomModel_1.RadixECKeyPair.SERIALIZER:
                    return new RadixAtomModel_1.RadixECKeyPair(output);
                case RadixAtomModel_1.RadixEncryptor.SERIALIZER:
                    return new RadixAtomModel_1.RadixEncryptor(output);
                case RadixAtomModel_1.RadixTransactionAtom.SERIALIZER:
                    return new RadixAtomModel_1.RadixTransactionAtom(output);
                case RadixAtomModel_1.RadixEmission.SERIALIZER:
                    return new RadixAtomModel_1.RadixEmission(output);
                case RadixAtomModel_1.RadixConsumable.SERIALIZER:
                    return new RadixAtomModel_1.RadixConsumable(output);
                case RadixAtomModel_1.RadixConsumer.SERIALIZER:
                    return new RadixAtomModel_1.RadixConsumer(output);
                case RadixAtomModel_1.RadixTokenClass.SERIALIZER:
                    return new RadixAtomModel_1.RadixTokenClass(output);
                case RadixAtomModel_1.RadixFeeConsumable.SERIALIZER:
                    return new RadixAtomModel_1.RadixFeeConsumable(output);
                case RadixAtomModel_1.RadixAtomFeeConsumable.SERIALIZER:
                    return new RadixAtomModel_1.RadixAtomFeeConsumable(output);
                default:
                    // console.log(`Serializer "${type}" not implemented`)
                    break;
            }
        }
        return output;
    };
    RadixSerializer.toJson = function (data) {
        var e_2, _a;
        if (Array.isArray(data)) {
            var output = [];
            try {
                for (var data_1 = tslib_1.__values(data), data_1_1 = data_1.next(); !data_1_1.done; data_1_1 = data_1.next()) {
                    var item = data_1_1.value;
                    output.push(RadixSerializer.toJson(item));
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (data_1_1 && !data_1_1.done && (_a = data_1.return)) _a.call(data_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
            return output;
        }
        else if (typeof data === 'string' ||
            typeof data === 'number' ||
            typeof data === 'boolean' ||
            data instanceof long_1.default) {
            return data;
        }
        else if (data !== null && typeof data === 'object') {
            if (typeof data.toJson === 'function') {
                return data.toJson();
            }
            else {
                var output = {};
                for (var key in data) {
                    var serialized = RadixSerializer.toJson(data[key]);
                    if (serialized) {
                        output[key] = serialized;
                    }
                }
                return output;
            }
        }
    };
    RadixSerializer.fromByteArray = function (bytes) {
        // Read 1 byte for type
        var type = bytes.readUInt8(0);
        // Read 4 bytes for length
        var length = bytes.readUInt32BE(1);
        // Switch on type
        switch (type) {
            case DataTypes.BOOLEAN: {
                return bytes.readUInt8(5) ? true : false;
            }
            case DataTypes.NUMBER: {
                return long_1.default.fromBytesBE(tslib_1.__spread(bytes.slice(5, 13))).toNumber();
            }
            case DataTypes.STRING: {
                return bytes.slice(5, 5 + length).toString('utf8');
            }
            case DataTypes.BYTES: {
                return new RadixAtomModel_1.RadixBase64(bytes.slice(5, 5 + length));
            }
            case DataTypes.OBJECT: {
                return this.fromObjectByteArray(bytes);
            }
            case DataTypes.ARRAY: {
                var output = [];
                var offset = 5;
                while (offset < length) {
                    // Read 2nd to 5th bytes to find out the length of the value
                    var valueLength = bytes.readUInt32BE(offset + 1);
                    output.push(this.fromByteArray(bytes.slice(offset, offset + 5 + valueLength)));
                    offset += 5 + valueLength;
                }
                return output;
            }
            case DataTypes.EUID: {
                return new RadixAtomModel_1.RadixEUID(bytes.slice(5, 5 + length));
            }
            case DataTypes.HASH: {
                return new RadixAtomModel_1.RadixHash(bytes.slice(5, 5 + length));
            }
        }
    };
    RadixSerializer.fromObjectByteArray = function (bytes) {
        // Read 4 bytes for length
        var length = bytes.readUInt32BE(1);
        var offset = 5;
        var output = {};
        while (offset < length + 5) {
            var keyLength = bytes.readUInt8(offset);
            offset++;
            var key = bytes.slice(offset, offset + keyLength).toString('utf8');
            offset += keyLength;
            // Read 2nd to 5th bytes to find out the length of the value
            var valueLength = bytes.readUInt32BE(offset + 1);
            output[key] = this.fromByteArray(bytes.slice(offset, offset + 5 + valueLength));
            offset += 5 + valueLength;
        }
        // Check if has serializer, cast
        if ('serializer' in output) {
            var type = output['serializer'];
            switch (type) {
                case RadixAtomModel_1.RadixNullAtom.SERIALIZER:
                    return new RadixAtomModel_1.RadixNullAtom(output);
                case RadixAtomModel_1.RadixNullJunk.SERIALIZER:
                    return new RadixAtomModel_1.RadixNullJunk(output);
                case RadixAtomModel_1.RadixSignature.SERIALIZER:
                    return new RadixAtomModel_1.RadixSignature(output);
                case RadixAtomModel_1.RadixBasicPayloadAtom.SERIALIZER:
                    return new RadixAtomModel_1.RadixBasicPayloadAtom(output);
                case RadixAtomModel_1.RadixECKeyPair.SERIALIZER:
                    return new RadixAtomModel_1.RadixECKeyPair(output);
                case RadixAtomModel_1.RadixEncryptor.SERIALIZER:
                    return new RadixAtomModel_1.RadixEncryptor(output);
                default:
                    // console.log(`Serializer "${type}" not implemented`)
                    break;
            }
        }
        return output;
    };
    RadixSerializer.toByteArray = function (data) {
        var e_3, _a, e_4, _b, e_5, _c;
        var output = new Buffer([]);
        if (Array.isArray(data)) {
            var type = DataTypes.ARRAY;
            var length_1 = 0;
            // Serialize all items
            var serialized = [];
            try {
                for (var data_2 = tslib_1.__values(data), data_2_1 = data_2.next(); !data_2_1.done; data_2_1 = data_2.next()) {
                    var item = data_2_1.value;
                    var serializedItem = this.toByteArray(item);
                    length_1 += serializedItem.length;
                    serialized.push(serializedItem);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (data_2_1 && !data_2_1.done && (_a = data_2.return)) _a.call(data_2);
                }
                finally { if (e_3) throw e_3.error; }
            }
            // Write everything to the buffer
            output = Buffer.alloc(length_1 + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length_1, 1);
            var position = 5;
            try {
                for (var serialized_1 = tslib_1.__values(serialized), serialized_1_1 = serialized_1.next(); !serialized_1_1.done; serialized_1_1 = serialized_1.next()) {
                    var item = serialized_1_1.value;
                    item.copy(output, position);
                    position += item.length;
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (serialized_1_1 && !serialized_1_1.done && (_b = serialized_1.return)) _b.call(serialized_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
        else if (typeof data === 'number' || data instanceof long_1.default) {
            var type = DataTypes.NUMBER;
            var length_2 = 8;
            var bufferData = (data instanceof long_1.default) ? Buffer.from(data.toBytes()) : Buffer.from(long_1.default.fromNumber(data).toBytes());
            output = Buffer.alloc(length_2 + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length_2, 1);
            bufferData.copy(output, 5);
        }
        else if (typeof data === 'object') {
            if (typeof data.toByteArray === 'function') {
                // Radix objects
                output = data.toByteArray();
            }
            else {
                // Generic object
                var type = DataTypes.OBJECT;
                var length_3 = 0;
                // Serialize all properties
                // Build a map sorted by property name
                var map = new typescript_map_1.TSMap();
                for (var key in data) {
                    var serializedValue = this.toByteArray(data[key]);
                    length_3 += key.length + 1 + serializedValue.length;
                    map.sortedSet(key, serializedValue);
                }
                // Write everything to the buffer
                output = Buffer.alloc(length_3 + 5);
                output.writeUInt8(type, 0);
                output.writeUInt32BE(length_3, 1);
                var position = 5;
                try {
                    for (var _d = tslib_1.__values(map.keys()), _e = _d.next(); !_e.done; _e = _d.next()) {
                        var key = _e.value;
                        var value = map.get(key);
                        output.writeUInt8(key.length, position);
                        position++;
                        output.write(key, position);
                        position += key.length;
                        value.copy(output, position);
                        position += value.length;
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (_e && !_e.done && (_c = _d.return)) _c.call(_d);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
            }
        }
        else if (typeof data === 'boolean') {
            var type = DataTypes.BOOLEAN;
            var length_4 = 1;
            output = Buffer.alloc(length_4 + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length_4, 1);
            output.writeUInt8(data ? 1 : 0, 5);
        }
        else if (typeof data === 'string') {
            var type = DataTypes.STRING;
            var bufferData = Buffer.from(data, 'utf8');
            var length_5 = bufferData.length;
            output = Buffer.alloc(length_5 + 5);
            output.writeUInt8(type, 0);
            output.writeUInt32BE(length_5, 1);
            bufferData.copy(output, 5);
        }
        else if (typeof data === 'function') {
            // Ignore
        }
        else {
            console.warn('Unknown type', data);
        }
        return output;
    };
    return RadixSerializer;
}());
exports.default = RadixSerializer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmFkaXhTZXJpYWxpemVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL21vZHVsZXMvc2VyaWFsaXplci9SYWRpeFNlcmlhbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsaURBQXNDO0FBRXRDLG9EQWtCMEI7QUFFMUIsc0RBQXVCO0FBRXZCLElBQVksU0FTWDtBQVRELFdBQVksU0FBUztJQUNqQiwrQ0FBVyxDQUFBO0lBQ1gsNkNBQVUsQ0FBQTtJQUNWLDZDQUFVLENBQUE7SUFDViwyQ0FBUyxDQUFBO0lBQ1QsNkNBQVUsQ0FBQTtJQUNWLDJDQUFTLENBQUE7SUFDVCx5Q0FBUSxDQUFBO0lBQ1IseUNBQVEsQ0FBQTtBQUNaLENBQUMsRUFUVyxTQUFTLEdBQVQsaUJBQVMsS0FBVCxpQkFBUyxRQVNwQjtBQUVEO0lBQUE7SUF3U0EsQ0FBQztJQXZTaUIsd0JBQVEsR0FBdEIsVUFBdUIsSUFBUzs7UUFDNUIsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3JCLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQTs7Z0JBQ2YsS0FBaUIsSUFBQSxTQUFBLGlCQUFBLElBQUksQ0FBQSwwQkFBQSw0Q0FBRTtvQkFBbEIsSUFBSSxJQUFJLGlCQUFBO29CQUNULE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFBO2lCQUM5Qzs7Ozs7Ozs7O1lBQ0QsT0FBTyxNQUFNLENBQUE7U0FDaEI7YUFBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtZQUNqQyxPQUFPLGVBQWUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUE7U0FDOUM7YUFBTTtZQUNILE9BQU8sSUFBSSxDQUFBO1NBQ2Q7SUFDTCxDQUFDO0lBRWEsOEJBQWMsR0FBNUIsVUFBNkIsVUFBa0I7UUFDM0MsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFBO1FBRWYsS0FBSyxJQUFJLEdBQUcsSUFBSSxVQUFVLEVBQUU7WUFDeEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLGVBQWUsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7U0FDMUQ7UUFFRCxJQUFJLFlBQVksSUFBSSxNQUFNLEVBQUU7WUFDeEIsSUFBSSxJQUFJLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFBO1lBRS9CLFFBQVEsSUFBSSxFQUFFO2dCQUNWLEtBQUssMEJBQVMsQ0FBQyxVQUFVO29CQUNyQixPQUFPLDBCQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNyQyxLQUFLLDBCQUFTLENBQUMsVUFBVTtvQkFDckIsT0FBTywwQkFBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDckMsS0FBSyw0QkFBVyxDQUFDLFVBQVU7b0JBQ3ZCLE9BQU8sNEJBQVcsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3ZDLEtBQUssOEJBQWEsQ0FBQyxVQUFVO29CQUN6QixPQUFPLElBQUksOEJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyw4QkFBYSxDQUFDLFVBQVU7b0JBQ3pCLE9BQU8sSUFBSSw4QkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNwQyxLQUFLLCtCQUFjLENBQUMsVUFBVTtvQkFDMUIsT0FBTyxJQUFJLCtCQUFjLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLEtBQUssc0NBQXFCLENBQUMsVUFBVTtvQkFDakMsT0FBTyxJQUFJLHNDQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUM1QyxLQUFLLDRDQUEyQixDQUFDLFVBQVU7b0JBQ3ZDLE9BQU8sSUFBSSw0Q0FBMkIsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDbEQsS0FBSywrQkFBYyxDQUFDLFVBQVU7b0JBQzFCLE9BQU8sSUFBSSwrQkFBYyxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNyQyxLQUFLLCtCQUFjLENBQUMsVUFBVTtvQkFDMUIsT0FBTyxJQUFJLCtCQUFjLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLEtBQUsscUNBQW9CLENBQUMsVUFBVTtvQkFDaEMsT0FBTyxJQUFJLHFDQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUMzQyxLQUFLLDhCQUFhLENBQUMsVUFBVTtvQkFDekIsT0FBTyxJQUFJLDhCQUFhLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3BDLEtBQUssZ0NBQWUsQ0FBQyxVQUFVO29CQUMzQixPQUFPLElBQUksZ0NBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDdEMsS0FBSyw4QkFBYSxDQUFDLFVBQVU7b0JBQ3pCLE9BQU8sSUFBSSw4QkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNwQyxLQUFLLGdDQUFlLENBQUMsVUFBVTtvQkFDM0IsT0FBTyxJQUFJLGdDQUFlLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3RDLEtBQUssbUNBQWtCLENBQUMsVUFBVTtvQkFDOUIsT0FBTyxJQUFJLG1DQUFrQixDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUN6QyxLQUFLLHVDQUFzQixDQUFDLFVBQVU7b0JBQ2xDLE9BQU8sSUFBSSx1Q0FBc0IsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDN0M7b0JBQ0ksc0RBQXNEO29CQUN0RCxNQUFLO2FBQ1o7U0FDSjtRQUVELE9BQU8sTUFBTSxDQUFBO0lBQ2pCLENBQUM7SUFFYSxzQkFBTSxHQUFwQixVQUFxQixJQUFTOztRQUMxQixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDckIsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFBOztnQkFDZixLQUFpQixJQUFBLFNBQUEsaUJBQUEsSUFBSSxDQUFBLDBCQUFBLDRDQUFFO29CQUFsQixJQUFJLElBQUksaUJBQUE7b0JBQ1QsTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUE7aUJBQzVDOzs7Ozs7Ozs7WUFDRCxPQUFPLE1BQU0sQ0FBQTtTQUNoQjthQUFNLElBQ0gsT0FBTyxJQUFJLEtBQUssUUFBUTtZQUN4QixPQUFPLElBQUksS0FBSyxRQUFRO1lBQ3hCLE9BQU8sSUFBSSxLQUFLLFNBQVM7WUFDekIsSUFBSSxZQUFZLGNBQUksRUFDdEI7WUFDRSxPQUFPLElBQUksQ0FBQTtTQUNkO2FBQU0sSUFBSSxJQUFJLEtBQUssSUFBSSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtZQUNsRCxJQUFJLE9BQU8sSUFBSSxDQUFDLE1BQU0sS0FBSyxVQUFVLEVBQUU7Z0JBQ25DLE9BQU8sSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFBO2FBQ3ZCO2lCQUFNO2dCQUNILElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQTtnQkFDZixLQUFLLElBQUksR0FBRyxJQUFJLElBQUksRUFBRTtvQkFDbEIsSUFBSSxVQUFVLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQTtvQkFDbEQsSUFBSSxVQUFVLEVBQUU7d0JBQ1osTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLFVBQVUsQ0FBQTtxQkFDM0I7aUJBQ0o7Z0JBRUQsT0FBTyxNQUFNLENBQUE7YUFDaEI7U0FDSjtJQUNMLENBQUM7SUFFYSw2QkFBYSxHQUEzQixVQUE0QixLQUFhO1FBQ3JDLHVCQUF1QjtRQUN2QixJQUFJLElBQUksR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQzdCLDBCQUEwQjtRQUMxQixJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBRWxDLGlCQUFpQjtRQUNqQixRQUFRLElBQUksRUFBRTtZQUNWLEtBQUssU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUNwQixPQUFPLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFBO2FBQzNDO1lBQ0QsS0FBSyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ25CLE9BQU8sY0FBSSxDQUFDLFdBQVcsa0JBQUssS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQTthQUM5RDtZQUNELEtBQUssU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUNuQixPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUE7YUFDckQ7WUFDRCxLQUFLLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDbEIsT0FBTyxJQUFJLDRCQUFXLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUE7YUFDckQ7WUFDRCxLQUFLLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDbkIsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUE7YUFDekM7WUFDRCxLQUFLLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDbEIsSUFBSSxNQUFNLEdBQWUsRUFBRSxDQUFBO2dCQUMzQixJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUE7Z0JBRWQsT0FBTyxNQUFNLEdBQUcsTUFBTSxFQUFFO29CQUNwQiw0REFBNEQ7b0JBQzVELElBQUksV0FBVyxHQUFHLEtBQUssQ0FBQyxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFBO29CQUVoRCxNQUFNLENBQUMsSUFBSSxDQUNQLElBQUksQ0FBQyxhQUFhLENBQ2QsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsTUFBTSxHQUFHLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FDaEQsQ0FDSixDQUFBO29CQUVELE1BQU0sSUFBSSxDQUFDLEdBQUcsV0FBVyxDQUFBO2lCQUM1QjtnQkFFRCxPQUFPLE1BQU0sQ0FBQTthQUNoQjtZQUNELEtBQUssU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNqQixPQUFPLElBQUksMEJBQVMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQTthQUNuRDtZQUNELEtBQUssU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNqQixPQUFPLElBQUksMEJBQVMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQTthQUNuRDtTQUNKO0lBQ0wsQ0FBQztJQUVhLG1DQUFtQixHQUFqQyxVQUFrQyxLQUFhO1FBQzNDLDBCQUEwQjtRQUMxQixJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBRWxDLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQTtRQUNkLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQTtRQUNmLE9BQU8sTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDeEIsSUFBSSxTQUFTLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUN2QyxNQUFNLEVBQUUsQ0FBQTtZQUNSLElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLE1BQU0sR0FBRyxTQUFTLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUE7WUFDbEUsTUFBTSxJQUFJLFNBQVMsQ0FBQTtZQUVuQiw0REFBNEQ7WUFDNUQsSUFBSSxXQUFXLEdBQUcsS0FBSyxDQUFDLFlBQVksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUE7WUFFaEQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQzVCLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLE1BQU0sR0FBRyxDQUFDLEdBQUcsV0FBVyxDQUFDLENBQ2hELENBQUE7WUFFRCxNQUFNLElBQUksQ0FBQyxHQUFHLFdBQVcsQ0FBQTtTQUM1QjtRQUVELGdDQUFnQztRQUNoQyxJQUFJLFlBQVksSUFBSSxNQUFNLEVBQUU7WUFDeEIsSUFBSSxJQUFJLEdBQUcsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFBO1lBRS9CLFFBQVEsSUFBSSxFQUFFO2dCQUNWLEtBQUssOEJBQWEsQ0FBQyxVQUFVO29CQUN6QixPQUFPLElBQUksOEJBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDcEMsS0FBSyw4QkFBYSxDQUFDLFVBQVU7b0JBQ3pCLE9BQU8sSUFBSSw4QkFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUNwQyxLQUFLLCtCQUFjLENBQUMsVUFBVTtvQkFDMUIsT0FBTyxJQUFJLCtCQUFjLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLEtBQUssc0NBQXFCLENBQUMsVUFBVTtvQkFDakMsT0FBTyxJQUFJLHNDQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFBO2dCQUM1QyxLQUFLLCtCQUFjLENBQUMsVUFBVTtvQkFDMUIsT0FBTyxJQUFJLCtCQUFjLENBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLEtBQUssK0JBQWMsQ0FBQyxVQUFVO29CQUMxQixPQUFPLElBQUksK0JBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQTtnQkFDckM7b0JBQ0ksc0RBQXNEO29CQUN0RCxNQUFLO2FBQ1o7U0FDSjtRQUVELE9BQU8sTUFBTSxDQUFBO0lBQ2pCLENBQUM7SUFFYSwyQkFBVyxHQUF6QixVQUEwQixJQUFTOztRQUMvQixJQUFJLE1BQU0sR0FBVyxJQUFJLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQTtRQUVuQyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDckIsSUFBSSxJQUFJLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQTtZQUMxQixJQUFJLFFBQU0sR0FBRyxDQUFDLENBQUE7WUFFZCxzQkFBc0I7WUFDdEIsSUFBSSxVQUFVLEdBQUcsRUFBRSxDQUFBOztnQkFDbkIsS0FBaUIsSUFBQSxTQUFBLGlCQUFBLElBQUksQ0FBQSwwQkFBQSw0Q0FBRTtvQkFBbEIsSUFBSSxJQUFJLGlCQUFBO29CQUNULElBQUksY0FBYyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUE7b0JBQzNDLFFBQU0sSUFBSSxjQUFjLENBQUMsTUFBTSxDQUFBO29CQUMvQixVQUFVLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFBO2lCQUNsQzs7Ozs7Ozs7O1lBRUQsaUNBQWlDO1lBQ2pDLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUNqQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUMxQixNQUFNLENBQUMsYUFBYSxDQUFDLFFBQU0sRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUUvQixJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUE7O2dCQUNoQixLQUFpQixJQUFBLGVBQUEsaUJBQUEsVUFBVSxDQUFBLHNDQUFBLDhEQUFFO29CQUF4QixJQUFJLElBQUksdUJBQUE7b0JBQ1QsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUE7b0JBQzNCLFFBQVEsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFBO2lCQUMxQjs7Ozs7Ozs7O1NBQ0o7YUFBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsSUFBSSxJQUFJLFlBQVksY0FBSSxFQUFFO1lBQ3pELElBQUksSUFBSSxHQUFHLFNBQVMsQ0FBQyxNQUFNLENBQUE7WUFDM0IsSUFBSSxRQUFNLEdBQUcsQ0FBQyxDQUFBO1lBQ2QsSUFBSSxVQUFVLEdBQUcsQ0FBQyxJQUFJLFlBQVksY0FBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFBO1lBRXBILE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUVqQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUMxQixNQUFNLENBQUMsYUFBYSxDQUFDLFFBQU0sRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUMvQixVQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQTtTQUM3QjthQUFNLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFO1lBQ2pDLElBQUksT0FBTyxJQUFJLENBQUMsV0FBVyxLQUFLLFVBQVUsRUFBRTtnQkFDeEMsZ0JBQWdCO2dCQUNoQixNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFBO2FBQzlCO2lCQUFNO2dCQUNILGlCQUFpQjtnQkFDakIsSUFBSSxJQUFJLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQTtnQkFDM0IsSUFBSSxRQUFNLEdBQUcsQ0FBQyxDQUFBO2dCQUVkLDJCQUEyQjtnQkFDM0Isc0NBQXNDO2dCQUN0QyxJQUFJLEdBQUcsR0FBRyxJQUFJLHNCQUFLLEVBQWtCLENBQUE7Z0JBQ3JDLEtBQUssSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFO29CQUNsQixJQUFJLGVBQWUsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO29CQUNqRCxRQUFNLElBQUksR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQTtvQkFDakQsR0FBRyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsZUFBZSxDQUFDLENBQUE7aUJBQ3RDO2dCQUVELGlDQUFpQztnQkFDakMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFBO2dCQUNqQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtnQkFDMUIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxRQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7Z0JBRS9CLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQTs7b0JBQ2hCLEtBQWdCLElBQUEsS0FBQSxpQkFBQSxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUEsZ0JBQUEsNEJBQUU7d0JBQXZCLElBQUksR0FBRyxXQUFBO3dCQUNSLElBQUksS0FBSyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7d0JBRXhCLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQTt3QkFDdkMsUUFBUSxFQUFFLENBQUE7d0JBQ1YsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUE7d0JBQzNCLFFBQVEsSUFBSSxHQUFHLENBQUMsTUFBTSxDQUFBO3dCQUN0QixLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQTt3QkFDNUIsUUFBUSxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUE7cUJBQzNCOzs7Ozs7Ozs7YUFDSjtTQUNKO2FBQU0sSUFBSSxPQUFPLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDbEMsSUFBSSxJQUFJLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQTtZQUM1QixJQUFJLFFBQU0sR0FBRyxDQUFDLENBQUE7WUFFZCxNQUFNLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUE7WUFFakMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDMUIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxRQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUE7WUFDL0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO1NBQ3JDO2FBQU0sSUFBSSxPQUFPLElBQUksS0FBSyxRQUFRLEVBQUU7WUFDakMsSUFBSSxJQUFJLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQTtZQUMzQixJQUFJLFVBQVUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQTtZQUMxQyxJQUFJLFFBQU0sR0FBRyxVQUFVLENBQUMsTUFBTSxDQUFBO1lBRTlCLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtZQUVqQyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUMxQixNQUFNLENBQUMsYUFBYSxDQUFDLFFBQU0sRUFBRSxDQUFDLENBQUMsQ0FBQTtZQUMvQixVQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQTtTQUM3QjthQUFNLElBQUksT0FBTyxJQUFJLEtBQUssVUFBVSxFQUFFO1lBQ25DLFNBQVM7U0FDWjthQUFNO1lBQ0gsT0FBTyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUE7U0FDckM7UUFFRCxPQUFPLE1BQU0sQ0FBQTtJQUNqQixDQUFDO0lBQ0wsc0JBQUM7QUFBRCxDQUFDLEFBeFNELElBd1NDIn0=